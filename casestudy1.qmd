---
title: "Your Informative Title Here"
subtitle: "Case Study 1" 
author:
  - name: "Radiah Khan"
  - name: "Catherine Weeks" 
  - name: "Mercer Mercer"
date: 2025-10-06
format: 
  pdf:
    geometry: 
      - left=1in
      - right=1in
      - top=1in
      - bottom=1in
execute: 
  echo: true
  message: false
  warning: false
---

```{r, include=FALSE}
#loading packages
library(tidyverse)
library(Sleuth2)
library(kableExtra)
library(broom)
```

# Introduction {#sec-intro}

We will introduce our research questions, background of the problem and the motive behind anayzing these questions.

## Background {#sec-background}

During the US presidential election of 2000, in Palm Beach County, Florida there was a confusing ballot that could have potentially influenced the election results for this county. Amidst the tight race between Gore and Bush, Palm Beach County had an unexpectedly high number of votes for Buchanan, from the Reform party. This may be because on the ballot, someone hastily voting for Gore could have easily mistaken which bubble to fill out and mistakenly cast a vote for Buchanan due to the confusing nature of the ballot compared to other counties.

## Research Questions {#sec-research}

In this case study, we aim to answer three questions:

-   Is there a significant relationship between Bush and Buchanan votes within Palm Beach County?
-   How does the relationship between Bush and Buchanan votes differ across other Florida counties?
-   How many miscast votes were there for Buchanan in Palm Beach County?

## Motivation behind the research questions {#sec-research-ques}

We want to determine if the ballot in the Palm Beach county lead to people mistakenly casting votes for Buchnan when they meant to cast the vote for Gore.

# Data Description {#sec-data}

In this section, we will introduce the variables we are going to use for this case study. Later, we are going to perform an exploratory data analysis to see the distribution of votes for both Buchnan and Bush.

## Variables Used {#sec-data-variables}

-   `County` : Names of the county in Florida during the 2000s election
-   `Buchanan2000` : Number of votes for Buchanan in the specific county in Florida during that election
-   `Bush2000` : Number of votes for Bush in the specific county in Florida during that election

## Exploratory Data Analysis {#sec-data-eda}

```{r, include=FALSE}
#loading the sleuth2 election data set
election <- Sleuth2::ex0825

#creating a variable where only Palm Beach is considered
election_pb <- election |>
filter(County == "Palm Beach")

#creating a variable where Palm Beach is not considered 
election_wo_pb <- election |> filter(County  != "Palm Beach")

#printing out the first 5 rows of the original data set
head(election, 5)

#printing out the row of the new Palm Beach data set 
head(election_pb)

#printing out the first 5 rows of the new data set that excludes Palm Beach
head(election_wo_pb,5)
```

```{r}
#creating a new variable that only contains Buchanan's election data
election_summary_buchanan <- election|>
  select(Buchanan2000)

#printing out the first 5 rows of the Buchanan table
head(election_summary_buchanan, 5)
```

```{r}
#creating a new variable that only contains Bush's election data
election_summary_bush <- election|>
  select(Bush2000)

#printing out the first 5 rows of the Bush table
head(election_summary_bush, 5)
```

```{r tab:Buchanan, warning=FALSE}
#Saving summary table of Buchanan election data
election_count_summary_buchanan <-summary(election_summary_buchanan)

#printing the summary table created above with captions.
kable(as.data.frame(election_count_summary_buchanan, 
      caption = "Summary of Vote Counts (Buchanan) in the 2000s Election"))
```

```{r, warning=FALSE}
#Saving summary table of Bush election data
election_count_summary_bush <-summary(election_summary_bush)

#printing the summary table created above with captions.
kable(as.data.frame(election_count_summary_bush, 
      caption = "Summary of Vote Counts (Bush) in the 2000s Election"))
```

```{r}
#Creating a new data set that is better for EDA
election_new <- election |>
  
  #pivoting longer to make separate box plots later
  pivot_longer(cols = c("Buchanan2000", "Bush2000"),
               names_to = "Candidate",
               values_to = "Count") |>
  mutate(Candidate = recode(Candidate,
                            "Bush2000" = "Bush",
                            "Buchanan2000" = "Buchanan"))

#printing out first 5 lines of new data frame
head(election_new, 5)

```

```{r fig-distribution-election, fig.cap=" "}

#creating a box plot with the pivoted data
ggplot(data = election_new,
       aes(x = Count, fill = Candidate))+
  geom_boxplot() +
  
  #adding a title and x label
  labs(title ="Vote Counts for Bush and Buchanan in Florida",
       x = "Vote Counts (In log scale)") +
  
  #creating multiple plots based on the candidate
  facet_wrap(~Candidate)+
  
  #scaling the x axis to log10 to make plot more legible 
  scale_x_log10()+
  
  #making the plot pretty :)
  theme_minimal()+
  theme(plot.margin = margin(10,10,10,10))  
  
```

From the @fig-distribution-election, these boxplots show the distribution of Bush and Buchanan votes in the different Florida counties. It is worth noting that the x axis has been changed to be log10, so the differences between the two plots are more significant. From this we can gather that Bush had an overall greater mean count of votes by a significant margin as well as a more consistent voter base across all counties. Meanwhile, Buchanan had less consistent voters, with some counties having much higher counts of votes than others, all while still maintaining lower vote counts than Bush overall.

# Analysis Model

We will use a simple linear regression model to determine the relationship between the votes for Bush and the votes for Buchanan.

-   **Null hypothesis** ($H_0$): $\beta = 0$\
    There is no linear relationship between the votes for Bush and the votes for Buchanan in the 2000 election across Florida counties.

-   **Alternative hypothesis** ($H_1$): $\beta \neq 0$\
    There is a linear relationship between the votes for Bush and the votes for Buchanan in the 2000 election across Florida counties.

The significance level for this test is $p = 0.05$, and the confidence interval is $95%$.

```{r tab:election-summary}

#Creating a lm comparing Buchanan's and Bush's 2000 election data
election_lm <- lm(Buchanan2000 ~ Bush2000, data = election)

#saving the summary table of the election lm
election_summary <- tidy(election_lm)

#printing the summary table
kable(election_summary, caption = "Regression summary")

```

```{r}

#Plotting the Bush and Buchanan data with a log transformation. 
ggplot(election, aes(x = log(Bush2000), y = log(Buchanan2000))) +
  geom_point() +
  
  #adding a line to the plot
  geom_smooth(method = "lm", col = "red") +
  
  #adding labels 
  labs(title = "Buchanan vs Bush 2000",
       x = "Bush",
       y = "Buchanan")+
  
  #making it pretty :)
  theme_minimal()
```

As seen in Table \@ref(tab:election-summary), we set up the regression equation:

$$E[Buchanan2000|Bush2000] = \beta_0 + \beta_1*Bush2000 + \epsilon$$ $$= 45.29 +  0.004917 *Bush2000 + \epsilon$$

```{r}
#saving residuals as a variable
residuals <- resid(election_lm)
```

```{r}
#plotting the residuals
plot(fitted(election_lm), residuals)

#adding a line at 0,0 to help the residual plot be more legible
abline(0,0)

```
