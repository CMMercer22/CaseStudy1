---
title: "Your Informative Title Here"
subtitle: "Case Study 1" 
author:
  - name: "Radiah Khan"
  - name: "Catherine Weeks" 
  - name: "Mercer Mercer"
date: 2025-10-06
format: 
  pdf:
    geometry: 
      - left=1in
      - right=1in
      - top=1in
      - bottom=1in
execute: 
  echo: true
  message: false
  warning: false
---

```{r, include=FALSE}
#loading packages
library(tidyverse)
library(Sleuth2)
library(kableExtra)
library(broom)
```

# Introduction {#sec-intro}

We will introduce our research questions, background of the problem and the motive behind anayzing these questions.

## Background {#sec-background}

During the US presidential election of 2000, in Palm Beach County, Florida there was a confusing ballot that could have potentially influenced the election results for this county. During the tight race between Gore and Bush, Palm Beach County had an unexpectedly high number of votes for Buchanan, from the Reform party. This may be due to a confusing ballot in this county, where if not read closely, someone attempting to cast a vote for Gore could have mistakenly filled in the circle for Buchanan.

## Research Questions {#sec-research}

In this case study, we aim to answer three questions:

-   Is there a significant relationship between Bush and Buchanan votes within Palm Beach County?
-   How does the relationship between Bush and Buchanan votes differ across other Florida counties?
-   How many miscast votes were there for Buchanan in Palm Beach County?

## Motivation behind the research questions {#sec-research-ques}

We want to determine if the ballot in the Palm Beach county lead to people mistakenly casting votes for Buchanan when they meant to cast the vote for Gore.

# Data Description {#sec-data}

In this section, we will introduce the variables we are going to use for this case study. Later, we are going to perform an exploratory data analysis to see the distribution of votes for both Buchanan and Bush.

## Variables Used {#sec-data-variables}

-   `County` : Names of the county in Florida during the 2000s election
-   `Buchanan2000` : Number of votes for Buchanan in the specific county in Florida during that election
-   `Bush2000` : Number of votes for Bush in the specific county in Florida during that election

## Exploratory Data Analysis {#sec-data-eda}

```{r, include=FALSE}
#loading the sleuth2 election data set
election <- Sleuth2::ex0825

#creating a variable where only Palm Beach is considered
election_pb <- election |>
filter(County == "Palm Beach")

#creating a variable where Palm Beach is not considered 
election_wo_pb <- election |> filter(County  != "Palm Beach")

#printing out the first 5 rows of the original data set
head(election, 5)

#printing out the row of the new Palm Beach data set 
head(election_pb)

#printing out the first 5 rows of the new data set that excludes Palm Beach
head(election_wo_pb,5)
```

```{r}
#creating a new variable that only contains Buchanan's election data
election_summary_buchanan <- election|>
  select(Buchanan2000)

#printing out the first 5 rows of the Buchanan table
head(election_summary_buchanan, 5)
```

```{r}
#creating a new variable that only contains Bush's election data
election_summary_bush <- election|>
  select(Bush2000)

#printing out the first 5 rows of the Bush table
head(election_summary_bush, 5)
```

```{r tab:Buchanan, warning=FALSE}
#Saving summary table of Buchanan election data
election_count_summary_buchanan <-summary(election_summary_buchanan)

#printing the summary table created above with captions.
kable(as.data.frame(election_count_summary_buchanan, 
      caption = "Summary of Vote Counts (Buchanan) in the 2000s Election"))
```

```{r, warning=FALSE}
#Saving summary table of Bush election data
election_count_summary_bush <-summary(election_summary_bush)

#printing the summary table created above with captions.
kable(as.data.frame(election_count_summary_bush, 
      caption = "Summary of Vote Counts (Bush) in the 2000s Election"))
```

```{r}
#Creating a new data set that is better for EDA
election_new <- election |>
  
  #pivoting longer to make separate box plots later
  pivot_longer(cols = c("Buchanan2000", "Bush2000"),
               names_to = "Candidate",
               values_to = "Count") |>
  mutate(Candidate = recode(Candidate,
                            "Bush2000" = "Bush",
                            "Buchanan2000" = "Buchanan"))

#printing out first 5 lines of new data frame
head(election_new, 5)

```

```{r fig-distribution-election, fig.cap=" "}

#creating a box plot with the pivoted data
ggplot(data = election_new,
       aes(x = Count, fill = Candidate))+
  geom_boxplot() +
  
  #adding a title and x label
  labs(title ="Vote Counts for Bush and Buchanan in Florida",
       x = "Vote Counts (In log scale)") +
  
  #creating multiple plots based on the candidate
  facet_wrap(~Candidate)+
  
  #scaling the x axis to log10 to make plot more legible 
  scale_x_log10()+
  
  #making the plot pretty :)
  theme_minimal()+
  theme(plot.margin = margin(10,10,10,10))  
  
```

From the @fig-distribution-election, these box plots show the distribution of Bush and Buchanan votes in the different Florida counties. It is worth noting that the x axis has been changed to be log10, so the differences between the two plots are more significant. From this we can gather that Bush had an overall greater mean count of votes by a significant margin as well as a more consistent voter base across all counties. Meanwhile, Buchanan had less consistent voters, with some counties having much higher counts of votes than others, all while still maintaining lower vote counts than Bush overall.

# Analysis Model

We will use a simple linear regression model to determine the relationship between the votes for Bush and the votes for Buchanan.

Assuming conditions are met for linear regression model.

```{r fig-pre-transformed, fig.cap=" "}
ggplot(election, aes(x = Bush2000, y = Buchanan2000)) +
  geom_point() +
  labs(title = "Buchanan vs Bush 2000",
       x = "Bush",
       y = "Buchanan")+
  theme_minimal()
```

```{r}
election_lm_pre <- lm((Buchanan2000) ~(Bush2000), data = election)
election_summary <- tidy(election_lm_pre)
kable(election_summary, caption = "Regression summary Before Transformation")
```

```{r fig-pre-fitted, fig.cap=" "}
plot(fitted(election_lm_pre), residuals)
abline(0,0)

```

```{r fig-pre-transformed-normality, fig.cap=""}
residuals <- resid(election_lm_pre)
qqnorm(residuals)
qqline(residuals, col="red")
```

From the @fig-pre-transformed, @fig-pre-fitted and the @fig-pre-transformed-normality, we can see that the data points are clustered. This does not meet the condition of linearity, and because of this we are going to re express the explanatory and response variables to hold the conditions.

Here is our post-transformation scatter plot.

```{r}
ggplot(election, aes(x = log(Bush2000), y = log(Buchanan2000))) +
  geom_point() +
  geom_smooth(method = "lm", col = "red") +
  labs(title = "Transformed Model of Buchanan vs Bush 2000 Regression Model",
       x = "Bush",
       y = "Buchanan")+
  theme_minimal()
```

### Linear Model

```{r}
election_lm_post <- lm(log(Buchanan2000) ~ log(Bush2000), data = election)

```

### Residual vs Fitted

```{r fig-post-fitted, fig.cap=" "}
plot(fitted(election_lm_post), residuals)
abline(0,0)

```

### Normality

```{r fig-post-transformed-normality, fig.cap=""}
residuals_post <- resid(election_lm_post)
qqnorm(residuals_post)
qqline(residuals_post, col="red")
```

After it is transformed, log($y_i$) = $\beta\_0$+$\beta_1log(x_i)$

-   **Null hypothesis** ($H_0$): $\beta = 0$\
    There is no linear relationship between the votes for Bush and the votes for Buchanan in the 2000 election across Florida counties.

-   **Alternative hypothesis** ($H_A$): $\beta \neq 0$\
    There is a linear relationship between the votes for Bush and the votes for Buchanan in the 2000 election across Florida counties.

The significance level for this test is $p = 0.05$, and the confidence interval is $95%$.

```{r tab:election-summary}
#Creating a lm comparing Buchanan's and Bush's 2000 election data
election_lm <- lm(Buchanan2000 ~ Bush2000, data = election)

#saving the summary table of the election lm
election_summary <- tidy(election_lm)

#printing the summary table
kable(election_summary, caption = "Regression summary")
```

The p-value is near 0; suggesting significant relationship.

```{r}
#Plotting the Bush and Buchanan data with a log transformation. 
ggplot(election, aes(x = log(Bush2000), y = log(Buchanan2000))) +
  geom_point() +
  
  #adding a line to the plot
  geom_smooth(method = "lm", col = "red") +
  
  #adding labels 
  labs(title = "Buchanan vs Bush 2000",
       x = "Bush",
       y = "Buchanan")+
  
  #making it pretty :)
  theme_minimal()
```

```{r}
#saving the summary table of the election lm (post transformation)
election_summary_post <- tidy(election_lm_post )

#printing the summary table (post transformation)

kable(election_summary_post, caption = "Regression summary Post Transformation")
```

As seen in Table \@ref(tab:election-summary), we set up the regression equation:

$$E[log(Buchanan2000)|log(Bush2000)] = \beta_0 + \beta_1*Bush2000 + \epsilon$$ $$= -2.5771236 +   0.7577224 *Bush2000 $$ p-value is 0; so the results are statistically significant which rejects the null hypothesis.

```{r}
new_election_conditioned<- data.frame
```


```{r}
prediction_intervals <- election_lm_post |>
  augment(interval = "prediction",
          conf.level = 0.95)
prediction_intervals
```

```{r}
election_transformed <- election |>
 mutate(
    `log(Buchanan2000)` = round(log(Buchanan2000), 2),
    `log(Bush2000)` = round(log(Bush2000), 2)
  )

election_transformed
```

```{r}
ggplot(data = election_transformed, 
       mapping = aes(x = `log(Buchanan2000)`, y = `log(Bush2000)`)) +
  geom_point()+
  geom_smooth(method = lm, formula=y~x, fill="red", alpha=0.5)+
geom_ribbon(data = prediction_intervals,
              aes(ymin = .lower, ymax= .upper),alpha = 0.25)+
  theme_bw()
```

```{r}
unique(election_lm_post)
```
```{r}
pred <- data.frame(Bush2000 = 152846)
election_lm_post |>
  augment(newdata = pred,
          interval = "prediction",
          conf.level = 0.95)|>
  select(c(".fitted", ".lower", ".upper"))|>
  exp()
```

We can say with 95% confidence that the number of Buchanan votes based on the number of Bush notes should be between 248 and 1,674 in Palm Beach County, FL. 
This is significantly different than the actual number of Buchanan votes in Palm Beach County, which is 3,407. Assuming some of the votes cast for Buchanan were meant to be cast for Gore, our prediction interval suggests there were likely 2,763 miscast votes.


## Summary

In this case study, we set out to determine if the ballot in the Palm Beach County lead to people mistakenly casting votes for Buchanan when they meant to cast the vote for Gore.
Based on our models and prediction intervals, the Buchanan votes from Palm Beach County, FL are significantly different than what we would expect to see. 
This brings us to the conclusion that the confusing ballot for this county likely affected the votes, and led many people to mistakenly vote for Buchanan when they meant to vote for Gore.

### Limitations 
Our major limitation is that we are limited to election data within Florida. We also don’t know if Buchanan had an abnormally large voter base located within Palm Beach Florida. We also cannot prove that the reason Buchanan had an abnormality large vote count was because of voter fraud. If that was the case the independence condition would have been violated. However all of these limitations do not seem either likely or significant enough to affect the overall outcome to the extent we saw in the election of 2000. 
